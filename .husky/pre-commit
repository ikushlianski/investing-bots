cd apps/botbox

STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx)$' | sed 's|^apps/botbox/||' || true)

if [ -n "$STAGED_FILES" ]; then
  echo "Linting staged files..."
  echo "$STAGED_FILES" | xargs pnpm exec eslint --fix
  echo "$STAGED_FILES" | xargs git add
fi

pnpm typecheck && \
pnpm test